{
  "info": {
    "name": "ServeRest API BDD Automation",
    "description": "Automa√ß√£o BDD da API ServeRest com cen√°rios estruturados em Given-When-Then",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "https://serverest.dev",
      "type": "string"
    },
    {
      "key": "authToken",
      "value": "",
      "type": "string"
    },
    {
      "key": "userId",
      "value": "",
      "type": "string"
    },
    {
      "key": "productId",
      "value": "",
      "type": "string"
    },
    {
      "key": "cartId",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "üîê CEN√ÅRIOS DE AUTENTICA√á√ÉO",
      "item": [
        {
          "name": "Cen√°rio: Login bem-sucedido com credenciais v√°lidas",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "// GIVEN - Credenciais v√°lidas",
                  "// WHEN - Realizo login",
                  "// THEN - Devo receber token de autentica√ß√£o",
                  "pm.test(\"STATUS CODE: 200 - Login realizado com sucesso\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "pm.test(\"TOKEN: Deve conter authorization token\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('authorization');",
                  "    pm.expect(jsonData.authorization).to.not.be.empty;",
                  "    pm.collectionVariables.set(\"authToken\", jsonData.authorization);",
                  "});",
                  "pm.test(\"MENSAGEM: Login realizado com sucesso\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.message).to.equal('Login realizado com sucesso');",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"fulano@qa.com\",\n  \"password\": \"teste\"\n}"
            },
            "url": "{{baseUrl}}/login"
          }
        },
        {
          "name": "Cen√°rio: Tentativa de login com credenciais inv√°lidas",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "// GIVEN - Credenciais inv√°lidas",
                  "// WHEN - Tento fazer login",
                  "// THEN - Devo receber erro de autentica√ß√£o",
                  "pm.test(\"STATUS CODE: 401 - N√£o autorizado\", function () {",
                  "    pm.response.to.have.status(401);",
                  "});",
                  "pm.test(\"MENSAGEM: Email e/ou senha inv√°lidos\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.message).to.equal('Email e/ou senha inv√°lidos');",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"invalido@qa.com\",\n  \"password\": \"senhaerrada\"\n}"
            },
            "url": "{{baseUrl}}/login"
          }
        }
      ]
    },
    {
      "name": "üë• CEN√ÅRIOS DE USU√ÅRIOS",
      "item": [
        {
          "name": "Cen√°rio: Listar todos os usu√°rios cadastrados",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "// GIVEN - Usu√°rios existem no sistema",
                  "// WHEN - Busco a lista de usu√°rios",
                  "// THEN - Devo receber lista com todos os usu√°rios",
                  "pm.test(\"STATUS CODE: 200 - Lista retornada com sucesso\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "pm.test(\"ESTRUTURA: Deve conter quantidade e lista de usu√°rios\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('quantidade');",
                  "    pm.expect(jsonData).to.have.property('usuarios');",
                  "    pm.expect(jsonData.usuarios).to.be.an('array');",
                  "});",
                  "pm.test(\"DADOS: Lista deve conter usu√°rios\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.usuarios.length).to.be.greaterThan(0);",
                  "});",
                  "pm.test(\"CAMPOS OBRIGAT√ìRIOS: Usu√°rio deve ter todos os campos\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    var firstUser = jsonData.usuarios[0];",
                  "    pm.expect(firstUser).to.include.all.keys('nome', 'email', 'password', 'administrador', '_id');",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": "{{baseUrl}}/usuarios"
          }
        },
        {
          "name": "Cen√°rio: Buscar usu√°rio por ID com formato inv√°lido",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "// GIVEN - ID de usu√°rio com formato inv√°lido",
                  "// WHEN - Busco usu√°rio por ID",
                  "// THEN - Devo receber erro de valida√ß√£o",
                  "pm.test(\"STATUS CODE: 400 - Requisi√ß√£o inv√°lida\", function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "pm.test(\"VALIDA√á√ÉO: Mensagem de formato de ID inv√°lido\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.id).to.equal('id deve ter exatamente 16 caracteres alfanum√©ricos');",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": "{{baseUrl}}/usuarios/usuario_inexistente_123"
          }
        }
      ]
    },
    {
      "name": "üõçÔ∏è CEN√ÅRIOS DE PRODUTOS",
      "item": [
        {
          "name": "Cen√°rio: Listar todos os produtos dispon√≠veis",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "// GIVEN - Produtos cadastrados no sistema",
                  "// WHEN - Busco a lista de produtos",
                  "// THEN - Devo receber lista com todos os produtos",
                  "pm.test(\"STATUS CODE: 200 - Lista retornada com sucesso\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "pm.test(\"ESTRUTURA: Deve conter quantidade e lista de produtos\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('quantidade');",
                  "    pm.expect(jsonData).to.have.property('produtos');",
                  "    pm.expect(jsonData.produtos).to.be.an('array');",
                  "});",
                  "pm.test(\"DADOS: Lista deve conter produtos\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.produtos.length).to.be.greaterThan(0);",
                  "});",
                  "pm.test(\"CAMPOS OBRIGAT√ìRIOS: Produto deve ter todos os campos\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    var firstProduct = jsonData.produtos[0];",
                  "    pm.expect(firstProduct).to.include.all.keys('nome', 'preco', 'descricao', 'quantidade', '_id');",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": "{{baseUrl}}/produtos"
          }
        },
        {
          "name": "Cen√°rio: Buscar produto por ID inexistente",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "// GIVEN - ID de produto com formato inv√°lido",
                  "// WHEN - Busco produto por ID",
                  "// THEN - Devo receber erro de valida√ß√£o",
                  "pm.test(\"STATUS CODE: 400 - Requisi√ß√£o inv√°lida\", function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "pm.test(\"VALIDA√á√ÉO: Mensagem de formato de ID inv√°lido\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.id).to.equal('id deve ter exatamente 16 caracteres alfanum√©ricos');",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": "{{baseUrl}}/produtos/produto_inexistente_123"
          }
        }
      ]
    },
    {
      "name": "üõí CEN√ÅRIOS DE CARRINHOS",
      "item": [
        {
          "name": "Cen√°rio: Listar todos os carrinhos",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "// GIVEN - Carrinhos existem no sistema",
                  "// WHEN - Busco a lista de carrinhos",
                  "// THEN - Devo receber lista com carrinhos",
                  "pm.test(\"STATUS CODE: 200 - Lista retornada com sucesso\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "pm.test(\"ESTRUTURA: Deve conter quantidade e lista de carrinhos\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('quantidade');",
                  "    pm.expect(jsonData).to.have.property('carrinhos');",
                  "    pm.expect(jsonData.carrinhos).to.be.an('array');",
                  "});",
                  "pm.test(\"CARRINHO V√ÅLIDO: Se houver carrinhos, devem ter estrutura correta\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    if (jsonData.quantidade > 0 && jsonData.carrinhos.length > 0) {",
                  "        var firstCart = jsonData.carrinhos[0];",
                  "        pm.expect(firstCart).to.have.property('produtos');",
                  "        pm.expect(firstCart.produtos).to.be.an('array');",
                  "        pm.expect(firstCart).to.have.property('_id');",
                  "    } else {",
                  "        console.log('Nenhum carrinho encontrado - cen√°rio v√°lido');",
                  "    }",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": "{{baseUrl}}/carrinhos"
          }
        },
        {
          "name": "Cen√°rio: Buscar carrinho por ID inexistente",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "// GIVEN - ID de carrinho com formato inv√°lido",
                  "// WHEN - Busco carrinho por ID",
                  "// THEN - Devo receber erro de valida√ß√£o",
                  "pm.test(\"STATUS CODE: 400 - Requisi√ß√£o inv√°lida\", function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "pm.test(\"VALIDA√á√ÉO: Mensagem de formato de ID inv√°lido\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.id).to.equal('id deve ter exatamente 16 caracteres alfanum√©ricos');",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": "{{baseUrl}}/carrinhos/carrinho_inexistente_123"
          }
        }
      ]
    },
    {
      "name": "üîÑ CEN√ÅRIOS DE FLUXO COMPLETO",
      "item": [
        {
          "name": "Cen√°rio: Fluxo completo - Login ‚Üí Listar Produtos ‚Üí Ver Carrinhos",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "// GIVEN - Usu√°rio autenticado",
                  "// WHEN - Acesso diferentes endpoints",
                  "// THEN - Devo conseguir executar fluxo completo",
                  "pm.test(\"FLUXO COMPLETO: Status 200 em todas as requisi√ß√µes\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "pm.test(\"FLUXO COMPLETO: Dados consistentes\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('quantidade');",
                  "    pm.expect(jsonData).to.have.property('carrinhos');",
                  "    console.log('Fluxo completo executado com sucesso');",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "{{authToken}}"
              }
            ],
            "url": "{{baseUrl}}/carrinhos"
          }
        }
      ]
    }
  ]
}